!function(){var t=function(){var t={top:0,right:5,bottom:0,left:5},n=270-t.left-t.right,o=220-t.top-t.bottom,e=0,s=Math.min(n,o)/2,i=s-e,r=50,a="#453020",l="#5F381E",d="#885134",u="#A74327",c="#CF794D",f="#EEA37C",g="#E5AB63",h="#EAA961",m="#EBC177",p="#2E5879",b="white",v="black",_="white",w=140,k=300,y=1,C=d3.svg.arc().outerRadius(i).innerRadius(r),x=d3.layout.pie().sort(null).value(function(t){return t.gross_num}),E=d3.scale.ordinal().range([a,l,d,u,c,f,g,h,m]),A=d3.select("#chart").append("svg").attr("width",n).attr("height",o).append("g").attr("transform","translate("+n/2+","+o/2+")");d3.json("../data/oscar.json",function(t,n){if(t)console.log("there is an error loading data "+t);else{var o=n.length;T(n,o),D()}$("#gross_num").addClass("button-select"),$("#budget_num").on("click",function(){$(".button").removeClass("button-select"),$("#budget_num").addClass("button-select")}),$("#gross_num").on("click",function(){$(".button").removeClass("button-select"),$("#gross_num").addClass("button-select")})});var T=function(t){function n(t){var n=t;x.value(function(t){return t[n]}),r=r.data(x),r.transition().duration(750).attrTween("d",R)}var o,e,s=[],i="gross_num";t.forEach(function(t){t.gross_num=+t.gross_num});var r=A.datum(t).selectAll("path").data(x).enter().append("path").style("fill",function(t){return s.push(E(t.data.id)),E(t.data.id)}).attr("class","arc pie").attr("id",function(t){return t.data.tag}).attr("d",C).each(function(t){this._current=t}).on("mouseover",function(){e="."+this.id,$(e).css("background-color",p).css("color","white"),o=d3.select(this).style("fill"),d3.select(this).style("fill",p)}).on("mouseout",function(){d3.select(this).style("fill",o),$(e).css("background-color",b).css("color",v)});$("#gross_num, #budget_num").on("click",function(){n(this.id),B(t,s,this.id),$("#subtitle").text("gross_num"==this.id?"Worldwide Gross (U.S. Dollars)":"Film Budget (U.S. Dollars)")}),B(t,s,i)},B=function(t,n,o){var e=$("#table-body");$(e).empty();var s=$("<table></table>");$(s).css("height",w),$.each(t,function(e){var i=$("<tr></tr>").addClass("ui-menu-item").addClass(t[e].tag),r=$("<td></td>").text(" ").css("background-color",n[e]);i.append(r),r=$("<td></td>").text(t[e].name),i.append(r),r=$("<td></td>").text("gross_num"===o?"$"+S(t[e].gross_num):"$"+S(t[e].budget_num)),i.append(r),s.append(i)}),$(e).append(s),j(t)},j=function(){var t,n;$(".ui-menu-item").on("mouseover",function(){n=$(this).attr("class").split(" ")[1],n=d3.select("#"+n),t=n.style("fill"),$(this).css("background-color",p).css("color","white"),n.style("fill",p)}).on("mouseout",function(){n.style("fill",t),$(this).css("background-color",_).css("color",v)})},D=function(){var t;$("#info-button, #embed-button, #embed-close, #info-close").on("click",function(){if(1===y){y=0;var n=$(this).attr("id").split("-")[0];n+="-text",F(n,t),t=n}})},F=function(t,n){$("#info-dropdown").is(":visible")?t===n?$("#info-dropdown").slideToggle(k,function(){y=1}):$("#info-dropdown").slideToggle(k,function(){$("#info-text").hide(),$("#embed-text").hide(),$("#"+t).show(),$("#info-dropdown").slideToggle(k),y=1}):($("#info-text").hide(),$("#embed-text").hide(),$("#"+t).show(),$("#info-dropdown").slideToggle(k,function(){y=1}))},S=function(t){var n=t.toString().split(".");return n[0]=n[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),n.join(".")},R=function(t){var n=d3.interpolate(this._current,t);return this._current=n(0),function(t){return C(n(t))}}};t()}(this,document);